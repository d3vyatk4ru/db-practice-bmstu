%%  A report on laboratory work 2.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage[2020-02-02]{latexrelease}

\documentclass[12pt,a4paper]{article}

%%  Стандартные языковые команды
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}

%%  Подключение стилевого файла отчета
\usepackage{kprj}

%%   Подключение пакета управления гиперссылками (только для pdftex)
\ifpdftex
   \usepackage[unicode=true]{hyperref}
   \hypersetup{pdfpagemode=UseNone, pdfstartview = FitR 0 0 200 1000}
   \BlackColorLinks
\fi

%%%  Для подключения рисунков (разные форматы при разном компилировании)
\ifpdftex
  % pdftex понимает форматы рисунков PNG, JPEG, PDF
  \DeclareGraphicsExtensions{.pdf}
\else
  % При создании DVI возможны практически все форматы, но EPS предпочтительнее
  \DeclareGraphicsExtensions{.eps}
\fi


%%%    Тип работы
\LabWork                      %   тип документа -- лабораторная работа
\LabWorkNo{1}                 %   номер лабораторной работы

%%%  Данные для оформления
\author{Д.Д.~Девяткин}                     %   автор
\workyear{2022}                         %   год выполнения работы
\title{Модель entity relation}   %  название
\discipline{Практикум по базам данных}              %  учебная дисциплина
\group{ФН12-21М}                         %   группа
\faculty{Фундаментальные науки}         %   Факультет
\chair{Математическое моделирование}    %   кафедра


\equationnumbering{section}

\begin{document}

%%%   Формирование титульного листа
\maketitle
%  Для формирования содержания
%\tableofcontents

\section{Постановка задачи}
Целью данной лабораторной работы является изучение метода моделирования данных «сущность-связь» и реализация этой модели.

Для решения этой задачи, необходимо сделать следующее:

\begin{enumerate}
	\item выбрать предметную область, соответствующую 4-5 сущностям;
	\item cформировать требования к предметной области;
	\item cоздать модель «сущность-связь» для предметной области с
обоснованием выбора кардинальных чисел связей;
	\item преобразовать модель «сущность-связь» в реляционную модель и обосновать выбор типов данных, ключей, правил обеспечения ограничений минимальной кардинальности.
\end{enumerate}

\section{Модель «сущность-связь»}
В качестве предметной области была выбрана область авиарейсов. Данная область подразумевает взаимодействие покупателей авиабилетов и рейса с авиабилетами. Так же у каждого рейса имеется своя модель самолета. В связи с этим к предметной области были сформулированы следующие требования:

\begin{enumerate}
	\item покупатель может купить 1 или несколько авиабилетов;
	\item у авиабилета может быть только 1 владелец;
	\item у авиабилета может быть только 1 рейс, но у рейса может быть несколько авиабилетов;
	\item в рейсе может участвовать только 1 самолет.
\end{enumerate}

На основе описанной предметной области была синтезирована модель «сущность-связь» (рис. 1), включающая 4 сущности:

\begin{itemize}
	\item Customer -- сущность, являющаяся абстракцией покупателя авиабилета, с идентификатором passport\_customer (паспорт клиент) и атрибутами: email (электронная почта покупателя), first\_name (имя покупателя) и last\_name (фамилия покупателя).
	\item Tickets --  сущность, являющаяся абстракцией авиабилета с идентификаторами ticket\_id (номер билета). Атрибутами являются seat\_id (номер места в самолете), passport\_ticket (паспорт держателя билета), first\_name (имя покупателя) и last\_name (фамилия покупателя). 
	\item Flights -- сущность, определяющая рейс. Идентификатором является номер (flight\_id) и дата (date) полета. Атрибуты сущности: аэропорт прилета (departure\_airport), arrival\_airport (аэропорт вылета), status (статус рейса) и amount (количество купленных билетов на рейс).
	
	\item Aircrafts -- сущность, представляющая абстракцию самолета. Идентификатором является aircraft\_id (номер самолета), атрибутом model (модель самолета).

\end{itemize}
\begin{figure}[h!]
  \centerline{\includegraphics[scale=0.85]{db-bmstu.png}}
  \vskip2mm
  \caption{ER модель.}\label{er_model}
\end{figure}

Между описанными сущностями были построены связи, согласующиеся с
принципами предметной области, описанными ранее. описанными ранее. Так как каждый покупатель может купить билеты на разных людей, но у каждого
билета должен быть только один владелец, то связь сущностей Customer и Tickets «один-ко-многим», а минимальные и максимальные кардинальные числа равны 1:1 и 0:N. Аналогичная связь между сущностями Flights и Aircrafts так как одному рейсу обязательно соответствует единственный самолет и между сущностями Flights и Tickets.
\newpage
\section{Реляционная модель}
Для сущностей выбираются первичные ключи. Для сущностей Tickets, Aircrafts и Customer в качестве первичного ключа выбираются идентификаторы. Для сущности Flights вводится сурогатный ключ FID. Реляционная модель представлена на рис. 2.

\begin{figure}[h!]
  \centerline{\includegraphics[scale=1]{rel-mod.png}}
  \vskip2mm
  \caption{Реляционная модель данных.}\label{rel_model}
\end{figure}

Нормализация не требуется, так как удовлетворяет условиям БКНФ (нормальной формы Бойса-Кодда).

Далее определялись типы данных для столбцов таблиц, соответствующие требованиям к предметной области.
\begin{figure}[h]
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=8cm]{customer_type.png}}
\end{minipage}
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=8cm]{aircrafts_type.png}}
\end{minipage}
\end{figure}
\begin{figure}[h]
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=8cm]{flight_type.png}}
\end{minipage}
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=8cm]{ticket_type.png}}
\end{minipage}
\end{figure}

Правила обеспечения ограничения минимальной кардинальности, также диктуются требованиями предметной области.

\begin{figure}[h!]
  \centerline{\includegraphics[scale=0.97]{min_card_1.png}}
\end{figure}

\begin{figure}[h!]
  \centerline{\includegraphics[scale=0.97]{min_card_2.png}}
  \vskip2mm
  \caption{Обеспечение минимальнйо кардинальности.}\label{rel_model}
\end{figure}

\end{document}
